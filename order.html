<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Order | Tea Testy Spots</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- PAYSTACK -->
<script src="https://js.paystack.co/v1/inline.js"></script>

<style>
body{
  background:#0f0f0f;
  color:#fff;
  font-family:Arial, sans-serif;
  padding:20px;
}
.container{
  max-width:500px;
  margin:auto;
}
h2{
  text-align:center;
  color:#c9a24d;
}
.form-group{
  margin-bottom:15px;
}
input, textarea{
  width:100%;
  height:50px;
  padding:10px;
  border-radius:8px;
  border:none;
  font-size:16px;
}
textarea{
  height:80px;
  resize:none;
}
label{
  display:block;
  margin-bottom:8px;
}
button{
  width:100%;
  height:55px;
  background:#c9a24d;
  color:#000;
  border:none;
  border-radius:30px;
  font-size:18px;
  font-weight:bold;
  cursor:pointer;
  margin-top:10px;
}
#submitBtn{
  opacity:0.5;
}
#receipt{
  display:none;
  background:#1a1a1a;
  padding:15px;
  border-radius:10px;
  margin-top:20px;
}
</style>
</head>

<body>
<div class="container">

<h2>Place Your Order</h2>

<div class="form-group">
  <input type="text" id="phone" placeholder="Phone Number" required>
</div>

<div class="form-group">
  <label>Select Food</label>
  <label><input type="checkbox" value="Awara - ‚Ç¶500" data-price="500" onchange="updateTotal()"> Awara (‚Ç¶500)</label>
  <label><input type="checkbox" value="Dan Wake - ‚Ç¶700" data-price="700" onchange="updateTotal()"> Dan Wake (‚Ç¶700)</label>
  <label><input type="checkbox" value="Gurasa - ‚Ç¶300" data-price="300" onchange="updateTotal()"> Gurasa (‚Ç¶300)</label>
</div>

<div class="form-group">
  <input type="text" id="price" placeholder="Total Price (‚Ç¶)" readonly>
</div>

<div class="form-group">
  <input type="time" id="time" required>
</div>

<div class="form-group">
  <textarea id="address" placeholder="Delivery Address" required></textarea>
</div>

<button onclick="payNow()">Pay Now</button>
<button id="submitBtn" onclick="sendOrder()" disabled>Submit Order</button>

<div id="receipt"></div>

</div>

<script>
let totalPrice = 0;
let selectedFoods = [];
let paymentDone = false;

function updateTotal(){
  totalPrice = 0;
  selectedFoods = [];
  document.querySelectorAll('input[type="checkbox"]:checked').forEach(item=>{
    totalPrice += parseInt(item.dataset.price);
    selectedFoods.push(item.value);
  });
  document.getElementById("price").value = totalPrice > 0 ? "‚Ç¶"+totalPrice : "";
}

function payNow(){
  let phone = document.getElementById("phone").value;
  if(phone=="" || totalPrice==0){
    alert("Please enter phone number and select food");
    return;
  }

  let handler = PaystackPop.setup({
    key: '',  // ‚ùå AN CIRE KEY ‚Äì saka LIVE key idan kin shirya real money
    email: 'muhammadsodangizainab@gmail.com',
    amount: totalPrice * 100,
    currency: 'NGN',
    callback: function(response){
      paymentDone = true;
      document.getElementById("submitBtn").disabled = false;
      document.getElementById("submitBtn").style.opacity = "1";
      alert("Payment successful ‚úÖ");
    },
    onClose: function(){
      alert("Payment not completed");
    }
  });
  handler.openIframe();
}

function sendOrder(){
  if(!paymentDone){
    alert("Please make payment first");
    return;
  }

  let phone = document.getElementById("phone").value;
  let time = document.getElementById("time").value;
  let address = document.getElementById("address").value;
  let foodList = selectedFoods.join(", ");

  let message =
  "PAID ORDER - TEA TESTY SPOTS\n\n"+
  "Foods: "+foodList+"\n"+
  "Total Paid: ‚Ç¶"+totalPrice+"\n"+
  "Phone: "+phone+"\n"+
  "Delivery Time: "+time+"\n"+
  "Address: "+address;

  // Email notification
  window.location.href =
  "mailto:muhammadsodangizainab@gmail.com"+
  "?subject=PAID Order - Tea Testy Spots"+
  "&body="+encodeURIComponent(message);

  // Receipt / Appreciation text
  document.getElementById("receipt").style.display = "block";
  document.getElementById("receipt").innerHTML =
  "<h3 style='color:#c9a24d;'>Thank you for your order ‚ù§Ô∏è</h3>"+
  "<p><b>Foods:</b> "+foodList+"</p>"+
  "<p><b>Total Paid:</b> ‚Ç¶"+totalPrice+"</p>"+
  "<p><b>Delivery Time:</b> "+time+"</p>"+
  "<p>We are preparing your food üçΩÔ∏è</p>";
}
</script>

</body>
</html>
